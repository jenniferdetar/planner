# Feature development workflow

---

## Workflow Steps

### [x] Step: Requirements

Your job is to generate a Product Requirements Document based on the feature description,

First, analyze the provided feature definition and determine unclear aspects. For unclear aspects: - Make informed guesses based on context and industry standards - Only mark with [NEEDS CLARIFICATION: specific question] if: - The choice significantly impacts feature scope or user experience - Multiple reasonable interpretations exist with different implications - No reasonable default exists - Prioritize clarifications by impact: scope > security/privacy > user experience > technical details

Ask up to 5 most priority clarifications to the user. Then, create the document following this template:

```
# Feature Specification: [FEATURE NAME]


## User Stories*


### User Story 1 - [Brief Title]

**Acceptance Scenarios**:

1. **Given** [initial state], **When** [action], **Then** [expected outcome]
2. **Given** [initial state], **When** [action], **Then** [expected outcome]

---

## Requirements*

## Success Criteria*

```

Save the PRD into `/Users/jenniferdetar/Library/CloudStorage/GoogleDrive-jennifermsamples@gmail.com/My Drive/Jennifer's Files/School/University of Texas at Austin/Personal/Opus One Planner/.zencoder/chats/3142f516-495d-4f4a-b936-99e9eed80bcc/requirements.md`.

### [x] Step: Technical Specification

Based on the PRD in `/Users/jenniferdetar/Library/CloudStorage/GoogleDrive-jennifermsamples@gmail.com/My Drive/Jennifer's Files/School/University of Texas at Austin/Personal/Opus One Planner/.zencoder/chats/3142f516-495d-4f4a-b936-99e9eed80bcc/requirements.md`, create a detailed technical specification to be used by a coding agent to implement the feature. Follow this template:

```
# Technical Specification: [FEATURE]

## Technical Context
Language/Version, primary dependencies, etc

## Technical Implementation Brief

Summarize key technical decisions for implementing the feature. Make sure they take into account the existing code as much as possible.

## Source Code Structure

## Contracts

Define addition or changes in data models, DB schemas, APIs, code interfaces etc

## Delivery Phases

Define several incremental deliverables for the feature. Each should be a minimal viable product testable end-to-end.

## Verification Strategy

Define how the coding agent can verify each deliverable it creates. Provide instructions for the agent to perform the verification using available tools (lint/test commands, bash commands) and create helper scripts and tools for more complex result verification.
The verification for each deliverable should be executable by a coding agent using built-in capabilities (lint and test commands from the project, bash commands), pre-generated helper scripts or MCP servers. Research and add to the spec:

- MCP servers that should be installed to help the agent with the verification

- helper scripts that need to be generated in the first phases of the plan to verify complex scenarios that can't be covered by the tests in the project's test framework(s)

- any sample input artifact(s) that are required for verification. Note if these artifacts can be a) generated by the agent; b) discovered by the agent on line; c) must be provided by the user.
```

Save the spec to `/Users/jenniferdetar/Library/CloudStorage/GoogleDrive-jennifermsamples@gmail.com/My Drive/Jennifer's Files/School/University of Texas at Austin/Personal/Opus One Planner/.zencoder/chats/3142f516-495d-4f4a-b936-99e9eed80bcc/spec.md`.

### [x] Step: Implementation Plan

Based on the technical spec in `/Users/jenniferdetar/Library/CloudStorage/GoogleDrive-jennifermsamples@gmail.com/My Drive/Jennifer's Files/School/University of Texas at Austin/Personal/Opus One Planner/.zencoder/chats/3142f516-495d-4f4a-b936-99e9eed80bcc/spec.md`, the following implementation tasks have been defined:

---

## PHASE 1: Daily Tasks & Core Infrastructure âœ… COMPLETE

### [x] Step: Create Core Data Management System (opus-storage.js)

**Task Definition**: Build the data persistence and storage layer that manages all CRUD operations for tasks, goals, notes, meetings, master tasks, and mission data.

**Contracts Referenced**: 
- Task, Goal, Note, Meeting, MasterTask, Mission, Preferences data models
- opus-storage.js API interface (all getter/setter methods)

**Deliverables**:
1. `/Mix/js/opus-storage.js` - Complete storage module with:
   - `initializeStorage()` - Load data from localStorage or initialize empty state
   - Task operations: CRUD + getTasksByDate, getTasksByGoal
   - Goal operations: CRUD + getGoalById
   - Note operations: CRUD + getNotesByDate
   - Meeting operations: CRUD + getMeetingsByDate
   - Master task operations: CRUD + scheduleTask conversion
   - Mission operations: getter/setter
   - Preferences operations: getter/setter
   - `saveToLocalStorage()` and `loadFromLocalStorage()`
   - UUID generation for all entities
   - Proper error handling and validation

**Expected Output Size**: 400-500 lines of JavaScript

**Verification Instructions**:
```bash
# In browser console:
# 1. Test initialization
await opusStorage.initializeStorage()

# 2. Create a task
const task = opusStorage.createTask({
  title: "Test Task",
  dueDate: "2026-01-15",
  priority: "High"
})
console.log(task) // Should have id, createdAt, updatedAt

# 3. Verify localStorage
JSON.parse(localStorage.getItem('opusData')).tasks.length > 0 // true

# 4. Test retrieval
opusStorage.getTaskById(task.id) // Should return the task
```

---

### [x] Step: Create State Management System (opus-data.js)

**Task Definition**: Build the in-memory state object and event system that serves as the single source of truth for the application. Implement reactive event listeners so UI updates when data changes.

**Contracts Referenced**:
- opusData object structure
- Event system interface (addEventListener, notifyListeners)
- Getter methods with business logic (getTodaysTasks, getGoalProgress, etc.)

**Deliverables**:
1. `/Mix/js/opus-data.js` - Complete data state module with:
   - Central `opusData` object holding all collections
   - Event system: addEventListener, removeEventListener, notifyListeners
   - High-level getters:
     - getTodaysTasks() - filter tasks for current date
     - getUpcomingMeetings(daysAhead) - meetings in next N days
     - getOverbookedDays() - dates with more tasks than working hours
     - getActiveGoals() - non-completed goals
     - getCompletedGoals() - completed goals
     - getGoalProgress(goalId) - percentage based on linked tasks
     - getMissionAlignment(goalId) - array of mission values
   - Load initial data from opusStorage on page init
   - Auto-sync to storage on data changes

**Expected Output Size**: 300-400 lines of JavaScript

**Verification Instructions**:
```bash
# In browser console:
# 1. Check data structure
console.log(opusData)

# 2. Test event listeners
opusData.addEventListener('task-created', (task) => {
  console.log('New task:', task)
})

# 3. Create task and verify event fires
opusStorage.createTask({title: "Test", dueDate: "2026-01-15"})

# 4. Test getters
opusData.getTodaysTasks() // Should return array
opusData.getActiveGoals() // Should return array
```

---

### [x] Step: Create Utilities Module (utils.js)

**Task Definition**: Build shared utility functions for date/time handling, formatting, UUID generation, and common transformations used across all modules.

**Contracts Referenced**:
- utils.js functions interface (generateId, formatDate, sortBy*, categorizeBy*)

**Deliverables**:
1. `/Mix/js/utils.js` - Complete utilities module with:
   - `generateId()` - UUIDv4 generation
   - `formatDate(date, format)` - Format dates (e.g., "Jan 15, 2026")
   - `formatTime(time)` - Format time strings (e.g., "2:30 PM")
   - `parseTimeString(time)` - Parse "14:30" to Date object
   - `getCurrentDateISO()` - Current date as YYYY-MM-DD
   - `isToday(date)`, `isFuture(date)` - Date comparisons
   - `getWeekDates(date)` - Array of 7 dates for week
   - `getMonthDates(date)` - Array of all dates in month
   - `getDayOfWeek(date)` - Day number (0-6)
   - `daysUntil(date)` - Numeric days until date
   - `sortTasksByPriority(tasks)` - High > Medium > Low
   - `sortTasksByTime(tasks)` - Sort by dueTime ascending
   - `categorizeByUrgenceImportance(tasks)` - Eisenhower Matrix categorization

**Expected Output Size**: 250-300 lines of JavaScript

**Verification Instructions**:
```bash
# In browser console:
# 1. Test UUID generation
const id = generateId()
console.log(id.match(/^[0-9a-f-]{36}$/)) // UUID format

# 2. Test date functions
formatDate(new Date(), "MMM DD, YYYY") // "Jan 15, 2026"
isToday(new Date()) // true
daysUntil("2026-02-15") // Number of days

# 3. Test sorting
const tasks = [
  {priority: "Low"}, {priority: "High"}, {priority: "Medium"}
]
const sorted = sortTasksByPriority(tasks)
console.log(sorted[0].priority) // "High"
```

---

### [x] Step: Create Daily Tasks HTML & CSS

**Task Definition**: Build the HTML structure and styling for the Daily Tasks view page, including task list, add task form, and task item displays.

**Contracts Referenced**:
- Task data model
- Existing CSS variables from base.css and home.css

**Deliverables**:
1. `/Mix/html/daily-tasks.html` - Complete HTML page with:
   - Standard planner layout (leather frame with left/right pages)
   - Add Task form (title, description, priority, date, time)
   - Task list display organized by time slots or priority
   - Task item elements with:
     - Checkbox for completion
     - Title, description, priority badge
     - Edit and delete buttons
     - Drag handle for reordering
   - Link to other features (Goals, Notes, etc.)

2. `/Mix/css/daily-tasks.css` - Styles including:
   - Task form styling (input, select, button)
   - Task item card styles
   - Priority color coding (High=red, Medium=orange, Low=blue)
   - Completed task visual state (strikethrough)
   - Overbooked day indicator
   - Responsive layout
   - Animations for add/remove

**Expected Output Size**: 
- HTML: 200-300 lines
- CSS: 300-400 lines

**Verification Instructions**:
```bash
# 1. Open /Mix/html/daily-tasks.html in browser
# 2. Verify visual elements:
# - Add Task form is visible
# - Task list container exists
# - Planner layout matches home.html aesthetic
# 3. Check CSS:
# - Priority badges have correct colors
# - Form styling is consistent with site
# - No layout breaks on 1024px width
```

---

### [x] Step: Create Daily Tasks JavaScript Module

**Task Definition**: Implement the JavaScript functionality for daily tasks including form handling, DOM rendering, event listeners, and integration with data layer.

**Contracts Referenced**:
- opus-storage.js (createTask, updateTask, deleteTask, getTasksByDate)
- opus-data.js (event listeners for task changes)
- utils.js (formatDate, formatTime, generateId)
- Daily task HTML structure

**Deliverables**:
1. `/Mix/js/daily-tasks.js` - Complete module with:
   - Initialize page: load tasks from storage
   - Form submission handler: validate and create task
   - Render functions:
     - renderTaskList() - populate DOM with tasks
     - renderTaskItem(task) - create task element
   - Event handlers:
     - Delete task button click
     - Edit task button (open modal/form)
     - Update task submission
     - Mark complete checkbox
   - Data listeners: respond to opus-data events
   - Drag-drop integration (setup on page load)

**Expected Output Size**: 400-500 lines of JavaScript

**Verification Instructions**:
```bash
# 1. Open daily-tasks.html in browser
# 2. Fill Add Task form and submit
# 3. Verify task appears in list
# 4. Refresh page - task still visible (persisted)
# 5. Click delete - task removed
# 6. Verify localStorage updated: 
JSON.parse(localStorage.getItem('opusData')).tasks
# 7. Edit task - verify update works
# 8. Mark complete - verify checkbox state changes
```

---

### [x] Step: Create Drag-Drop Utilities Module (drag-drop.js)

**Task Definition**: Build reusable drag-and-drop functions using HTML5 Drag & Drop API for task reordering and scheduling operations.

**Contracts Referenced**:
- opus-storage.js (updateTask with new date/time)
- opus-data.js (event notifications)
- Task data model

**Deliverables**:
1. `/Mix/js/drag-drop.js` - Complete drag-drop utilities with:
   - `initializeDragDrop(containerSelector)` - Setup draggable and droppable elements
   - `makeTaskDraggable(element, task)` - Add drag handlers to task element
   - `makeDropZone(element, onDrop)` - Create drop target
   - `scheduleDraggedTask(task, newDate, newTime)` - Update task and sync storage
   - `reprioritizeTask(task, newPosition)` - Reorder tasks in list
   - Visual feedback during drag (ghost image, drop zones highlighted)
   - Keyboard fallback (Tab + Arrow keys) for accessibility

**Expected Output Size**: 300-400 lines of JavaScript

**Verification Instructions**:
```bash
# 1. Open daily-tasks.html
# 2. Try to drag a task in the list - should show drag cursor
# 3. Drop task - list reorders, storage updates
# 4. Refresh - reordered list persists
# 5. Test keyboard: Tab to task, then Ctrl+Arrow to move
```

---

### [x] Step: Create opus-core.css (Shared Opus Styles)

**Task Definition**: Create a shared CSS module with Opus One-specific variables, layout patterns, and components used across all Opus modules.

**Deliverables**:
1. `/Mix/css/opus-core.css` - Shared styles with:
   - Opus One color palette (if different from CSEA)
   - Modal/form styles
   - Button styles (primary, secondary, danger)
   - Card/list item styles
   - Toast notification styles
   - Common spacing utilities
   - Animation keyframes (fade-in, slide, bounce)

**Expected Output Size**: 200-300 lines of CSS

---

## PHASE 2: Goals & Mission

### [ ] Step: Create Mission HTML & CSS + JavaScript

**Task Definition**: Build mission statement editor page allowing users to define and edit personal mission statement and core values.

**Contracts Referenced**:
- Mission data model
- opus-storage.js (getMission, updateMission)

**Deliverables**:
1. `/Mix/html/mission.html` - Page with:
   - Mission statement textarea (large, prominent)
   - Values list (add/remove core values)
   - Last updated timestamp
   - Save button

2. `/Mix/css/mission.css` - Styles for mission page

3. `/Mix/js/mission.js` - Load mission, handle edits, save to storage

**Expected Output Size**: 
- HTML: 150 lines
- CSS: 150 lines
- JS: 200 lines

---

### [ ] Step: Create Goals HTML, CSS & JavaScript Module

**Task Definition**: Build goals management page with CRUD operations, category/timeframe selection, mission alignment, and progress tracking.

**Contracts Referenced**:
- Goal data model
- opus-storage.js (createGoal, updateGoal, deleteGoal, getGoals)
- opus-data.js (getGoalProgress, getMissionAlignment, event listeners)

**Deliverables**:
1. `/Mix/html/goals.html` - Page with:
   - Create goal form (title, description, category, timeframe, mission alignment)
   - Goals list showing progress bars
   - Edit/delete controls

2. `/Mix/css/goals.css` - Goal card styles, progress bar

3. `/Mix/js/goals.js` - Form handling, render functions, event listeners

**Expected Output Size**: 
- HTML: 200 lines
- CSS: 250 lines
- JS: 400 lines

---

## PHASE 3: Notes & Meetings

### [ ] Step: Create Notes HTML, CSS & JavaScript Module

**Task Definition**: Build daily notes page allowing users to write, edit, and search dated notes with tagging support.

**Contracts Referenced**:
- Note data model
- opus-storage.js (createNote, updateNote, deleteNote, getNotesByDate)

**Deliverables**:
1. `/Mix/html/notes.html` - Page with:
   - Date picker (select which day's notes to view/edit)
   - Large textarea for note content
   - Tag input and display
   - Save button

2. `/Mix/css/notes.css` - Notes display styles

3. `/Mix/js/notes.js` - Load notes by date, handle edits, search

**Expected Output Size**: 
- HTML: 150 lines
- CSS: 150 lines
- JS: 250 lines

---

### [ ] Step: Create Meetings HTML, CSS & JavaScript Module

**Task Definition**: Build meeting planner page with full CRUD for meetings including attendees, location, agenda, and integration with calendar/daily views.

**Contracts Referenced**:
- Meeting data model
- opus-storage.js (createMeeting, updateMeeting, deleteMeeting, getMeetingsByDate)

**Deliverables**:
1. `/Mix/html/meetings.html` - Page with:
   - Create meeting form (title, date, time range, location, attendees, agenda)
   - Meetings list with upcoming meetings highlighted
   - Edit/delete controls

2. `/Mix/css/meetings.css` - Meeting card styles

3. `/Mix/js/meetings.js` - Form handling, render, validation

**Expected Output Size**: 
- HTML: 200 lines
- CSS: 200 lines
- JS: 350 lines

---

## PHASE 4: Master Tasks & Drag-Drop

### [ ] Step: Create Master Tasks HTML, CSS & JavaScript Module

**Task Definition**: Build master task management page for unscheduled tasks, with drag-to-schedule functionality.

**Contracts Referenced**:
- MasterTask data model
- opus-storage.js (createMasterTask, updateMasterTask, deleteMasterTask, getMasterTasks, scheduleTask)
- drag-drop.js (makeTaskDraggable, scheduleDraggedTask)

**Deliverables**:
1. `/Mix/html/master-tasks.html` - Page with:
   - Add master task form (title, description, priority, category)
   - Master tasks list organized by category
   - Drag handles visible
   - Instructions: "Drag tasks to calendar to schedule"

2. `/Mix/css/master-tasks.css` - Master task list styles, drag indicators

3. `/Mix/js/master-tasks.js` - CRUD, rendering, drag-drop integration

**Expected Output Size**: 
- HTML: 150 lines
- CSS: 150 lines
- JS: 300 lines

---

### [ ] Step: Enhance drag-drop.js with Master Task Scheduling

**Task Definition**: Extend drag-drop module to handle moving master tasks to calendar dates, converting them to scheduled tasks.

**Contracts Referenced**:
- opus-storage.js (scheduleTask method)
- Master task HTML elements

**Deliverables**:
1. Update `/Mix/js/drag-drop.js`:
   - Add `scheduleTaskFromMaster(masterTask, date, time)` 
   - Remove from master tasks list
   - Create scheduled task with date/time
   - Update storage

---

## PHASE 5: Multi-View Planner System

### [ ] Step: Create Planner Views Hub (planner-views.html, CSS, JS)

**Task Definition**: Build central planner page with multiple view modes (Daily, Weekly, Monthly, Eisenhower Matrix) that share the same underlying task data.

**Contracts Referenced**:
- All data models
- opus-data.js (getTodaysTasks, getWeekDates, getMonthDates, getGoalProgress, etc.)
- utils.js (date/time formatting and sorting)

**Deliverables**:
1. `/Mix/html/planner-views.html` - Page with:
   - View selector buttons (Daily, Weekly, Monthly, Eisenhower)
   - Container for selected view
   - Sidebar with upcoming meetings and goals

2. `/Mix/css/planner-views.css` - Styles for all 4 view layouts:
   - Daily: Hourly time slots (6AM-8PM)
   - Weekly: 7-column grid by day
   - Monthly: Calendar grid (6x7)
   - Eisenhower: 2x2 quadrant matrix

3. `/Mix/js/planner-views.js` - Large module with:
   - View state management
   - Render functions for each view
   - Event handlers for view switching
   - Drag-drop integration for each view
   - Update display when data changes

**Expected Output Size**: 
- HTML: 300 lines
- CSS: 500-600 lines (complex layouts)
- JS: 800-1000 lines (4 view renderers)

**Verification Instructions**:
```bash
# 1. Open planner-views.html
# 2. Click "Daily View" - see hourly slots with tasks
# 3. Click "Weekly View" - see 7 columns with days
# 4. Click "Monthly View" - see calendar grid
# 5. Click "Eisenhower" - see 4 quadrants
# 6. Switch views - data consistent across views
# 7. Drag task in daily view to new time
# 8. Switch to weekly view - task appears at new time
```

---

## PHASE 6: Integration & Polish

### [ ] Step: Update Home Page Navigation

**Task Definition**: Add links to all new Opus One features on home.html and update dashboard navigation.

**Deliverables**:
1. Update `/Mix/html/home.html`:
   - Add links to daily-tasks, goals, notes, meetings, master-tasks, mission, planner-views
   - Organize in "Opus One" section separate from existing links

2. Update `/Mix/js/home.js`:
   - Load pages.json dynamically
   - Add Opus One pages to pages.json

---

### [ ] Step: Create Preferences/Settings Page

**Task Definition**: Build settings page for user preferences (theme, default view, work hours, time format, etc.).

**Deliverables**:
1. `/Mix/html/settings.html` - Settings form with:
   - Theme selector (light/dark)
   - Default view selector
   - Work hours (start/end hour)
   - Time format (12h/24h)
   - Week start day selector

2. `/Mix/css/settings.css` - Settings form styles

3. `/Mix/js/settings.js` - Load/save preferences to storage

**Expected Output Size**: 
- HTML: 150 lines
- CSS: 100 lines
- JS: 150 lines

---

### [ ] Step: Implement Export/Import Data

**Task Definition**: Add data export/import functionality for backup and data portability.

**Deliverables**:
1. Add to opus-storage.js:
   - `exportData()` - Return full opusData as JSON string
   - `importData(jsonString)` - Parse and restore opusData

2. Create `/Mix/html/data-management.html`:
   - Export button (downloads opusData.json)
   - Import button (upload JSON file)
   - Clear all data warning

---

### [ ] Step: Final Testing & Performance Optimization

**Task Definition**: Comprehensive testing, bug fixes, performance optimization, and polish.

**Deliverables**:
1. Test checklist:
   - [ ] All CRUD operations work
   - [ ] Data persists across page refreshes
   - [ ] Drag-drop works smoothly
   - [ ] All views render correctly
   - [ ] No console errors
   - [ ] Responsive on 1024px width
   - [ ] Works on macOS Safari and Chrome

2. Performance optimizations:
   - Minimize DOM reflows during rendering
   - Lazy-load heavy view modules
   - Cache selector queries
   - Debounce frequent updates

3. Polish:
   - Add success toast notifications
   - Keyboard shortcuts documentation
   - Loading states
   - Error messages
   - Empty state messages

---

## Summary

Total tasks across 6 phases: 20+ implementation tasks
Estimated total code: ~9000 lines of HTML/CSS/JavaScript
Estimated development time: 40-60 hours
