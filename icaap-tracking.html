<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Icaap Tracking - Home Planner</title>
    <link href="https://fonts.googleapis.com/css2?family=Coming+Soon&family=Plus+Jakarta+Sans:wght@400&display=swap" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <script src="shared.js"></script>
    <style>
        :root {
            --header-blue: #00326b;
            --table-green: #1b5e20;
            --border-color: #e1dfdd;
            --section-sidebar-width: 60px;
        }
        body {
            background-color: #f3f2f1;
            margin: 0;
            padding: 0;
            font-family: 'Segoe UI', -apple-system, BlinkMacSystemFont, "Roboto", sans-serif;
            height: 100vh;
            display: flex;
            flex-direction: column;
            overflow: hidden;
        }
        .notebook-container {
            display: flex;
            flex-grow: 1;
            overflow: hidden;
            background: #fff;
        }
        /* Vertical Sidebar */
        .section-sidebar {
            width: var(--section-sidebar-width);
            background: #1e3a63;
            display: flex;
            flex-direction: column;
            align-items: center;
            padding-top: 20px;
            gap: 15px;
            flex-shrink: 0;
            box-shadow: inset -1px 0 0 rgba(0,0,0,0.1);
        }
        .section-icon {
            width: 42px;
            height: 42px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: #fff;
            border-radius: 10px;
            cursor: pointer;
            font-size: 1.3rem;
            transition: all 0.2s ease;
            text-decoration: none;
            opacity: 0.7;
        }
        .section-icon:hover {
            background: rgba(255,255,255,0.1);
            opacity: 1;
            transform: scale(1.05);
        }
        .section-icon.active {
            background: rgba(255,255,255,0.15);
            box-shadow: 0 4px 10px rgba(0,0,0,0.2);
            opacity: 1;
        }
        .section-icon.logout-icon {
            margin-top: auto;
            margin-bottom: 20px;
            opacity: 0.5;
        }
        .section-icon.logout-icon:hover {
            opacity: 1;
            color: #ffcdd2;
        }

        .notebook-main {
            flex-grow: 1;
            background: #fff;
            overflow-y: auto;
            position: relative;
            scrollbar-width: thin;
        }
        .notebook-page {
            width: 100%;
            max-width: 1800px;
            margin: 0 auto;
            padding: 40px !important;
            background: #fff;
            box-sizing: border-box;
            min-height: 100%;
        }

        .page-header {
            text-align: center;
            margin-bottom: 30px;
            border-bottom: 1px solid #e1dfdd;
            padding-bottom: 20px;
        }
        .page-title {
            font-family: 'Plus Jakarta Sans', sans-serif;
            font-size: 1.8rem;
            color: var(--header-blue);
            margin: 0 0 15px 0;
            letter-spacing: -0.01em;
            font-weight: 700;
        }

        .tracking-links-container {
            display: flex;
            justify-content: center;
            gap: 15px;
            margin-top: 20px;
        }
        .tracking-pill {
            display: inline-flex;
            align-items: center;
            gap: 8px;
            background-color: #f3f2f1;
            color: #323130;
            padding: 8px 16px;
            border-radius: 4px;
            text-decoration: none;
            font-size: 0.85rem;
            font-weight: 600;
            transition: all 0.2s;
            border: 1px solid #e1dfdd;
            font-family: 'Segoe UI', sans-serif;
        }
        .tracking-pill:hover {
            background-color: #edebe9;
            border-color: #d2d0ce;
        }
        .tracking-pill span {
            font-size: 1.1rem;
        }

        .table-container {
            width: 100%;
            overflow-x: auto;
            border: 1px solid #e1dfdd;
            border-radius: 4px;
            margin-top: 20px;
            position: relative;
        }
        .tracking-table {
            border-collapse: collapse;
            width: 100%;
            font-size: 0.8rem;
        }
        .tracking-table th, .tracking-table td {
            border: 1px solid #eee;
            padding: 8px;
            text-align: center;
        }
        .header-row th {
            background-color: #f8f9fa;
            color: #323130;
            font-weight: 600;
            font-family: 'Segoe UI', sans-serif;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            font-size: 0.7rem;
            border-bottom: 2px solid #e1dfdd;
            position: sticky;
            top: 0;
            z-index: 10;
        }
        .sub-header th {
            background-color: #fafafa;
            position: sticky;
            top: 35px; /* Adjust based on header height */
            z-index: 10;
            font-size: 0.65rem;
            color: #605e5c;
        }
        .employee-col {
            font-weight: 600;
            text-align: left !important;
            min-width: 180px;
            position: sticky;
            left: 0;
            background-color: #fff;
            z-index: 15;
            border-right: 2px solid #e1dfdd !important;
            font-family: 'Segoe UI', sans-serif;
        }
        .header-row .employee-col, .sub-header .employee-col {
            background-color: #f8f9fa;
            z-index: 20;
        }
        .total-col {
            background-color: #f8f9fa;
            font-weight: 700;
            border-left: 2px solid #e1dfdd !important;
        }
        
        .editable-cell {
            outline: none;
            min-height: 20px;
            background-color: #fff;
            font-family: 'Coming Soon', cursive;
            font-size: 0.9rem;
        }
        .editable-cell:focus {
            background-color: #fffde7;
            box-shadow: inset 0 0 0 2px var(--header-blue);
        }
        
        .save-status {
            position: fixed;
            bottom: 20px;
            right: 20px;
            background: rgba(255, 255, 255, 0.9);
            padding: 5px 15px;
            border-radius: 20px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
            font-size: 0.75rem;
            color: #666;
            z-index: 2000;
        }
    </style>
</head>
<body>
    <div class="notebook-container">
        <aside class="section-sidebar">
            <a href="index.html" class="section-icon" title="Home">üè†</a>
            <a href="notebook.html?category=Work-Planner" class="section-icon active" title="Work">üíº</a>
            <a href="notebook.html?category=Goals" class="section-icon" title="Personal">üë§</a>
            <a href="notebook.html?category=Intentions" class="section-icon" title="Planning">üìÖ</a>
            <a href="notebook.html?category=Budget" class="section-icon" title="Financial">üí∞</a>
            <div class="section-icon logout-icon" onclick="logout()" title="Logout">üö™</div>
        </aside>

        <main class="notebook-main">
            <div class="notebook-page">
                <div class="page-header">
                    <h1 class="page-title">Icaap Tracking Log</h1>
                    <div class="tracking-links-container">
                        <a href="icaap.html" class="tracking-pill">
                            <span>üìù</span> Icaap Notes
                        </a>
                        <a href="icaap-attendance.html" class="tracking-pill">
                            <span>üë§</span> Attendance Tracking
                        </a>
                    </div>
                </div>

                <div class="table-container">
                    <table class="tracking-table">
                        <thead>
                            <tr class="header-row">
                                <script>
                                    const urlParams = new URLSearchParams(window.location.search);
                                    const dateParam = urlParams.get('date');
                                    let baseDate = dateParam ? new Date(dateParam) : new Date();
                                    if (isNaN(baseDate.getTime())) baseDate = new Date();
                                    
                                    // Determine fiscal year start (July)
                                    let startYear = baseDate.getMonth() < 6 ? baseDate.getFullYear() - 1 : baseDate.getFullYear();
                                    
                                    const months = [];
                                    const monthNames = [
                                        'July', 'August', 'September', 'October', 
                                        'November', 'December', 'January', 'February', 
                                        'March', 'April', 'May', 'June'
                                    ];
                                    
                                    for (let i = 0; i < 12; i++) {
                                        const year = i < 6 ? startYear : startYear + 1;
                                        months.push(`${monthNames[i]} ${year}`);
                                    }

                                    document.write(`<th rowspan="2" class="employee-col">Employee Name</th>`);
                                    months.forEach(month => {
                                        document.write(`<th colspan="3">${month}</th>`);
                                    });
                                    document.write(`<th rowspan="2" class="total-col">Total Hours</th>`);
                                </script>
                            </tr>
                            <tr class="sub-header">
                                <script>
                                    months.forEach(month => {
                                        document.write(`<th>Paylog Sub.</th><th>Hours</th><th>Approval</th>`);
                                    });
                                </script>
                            </tr>
                        </thead>
                        <tbody id="tracking-body">
                        </tbody>
                    </table>
                </div>
            </div>
        </main>
    </div>
    <div id="save-status" class="save-status">All changes saved</div>
    <script>
        const employees = [
            "Adalid Sanchez Rodriguez", "Adan Saucedo", "Adrian Irvine", "Adriana Gomez",
            "Adriana Ojeda", "Agnes Lewis", "Alberto Solorzano", "Alexander Aston",
            "Alexis Contreras", "Alice Hilal", "Alicia Cerna", "Aline Millan",
            "Alyson Han", "Amber Mastroianni", "Amber Trudgeon", "Amber Wilton",
            "Ameel Noos", "Amparo Martin", "Ana Guevara", "Ancelmo Ramos",
            "Andrea Chagoya", "Andrea Douglas", "Andreina Morales", "Angel Gamino",
            "Angela Lopez", "Anna Quezada", "Anthony Bernard", "Anthony Morales",
            "Anthony Zarate", "Antoinette Matiga", "Araksya Manukyan", "Avia Greene-Vanburen",
            "Aya Shigenaga", "Baharak Saadat Beheshti", "Barbara Stoliker", "Barry Blisten",
            "Beatris Segura", "Bennett Winter", "Bernice Grewell-Godinez", "Beverly Junio-Magee",
            "Bienvenido Pineda", "Brigette Pena", "Carmen Fuentes", "Cassondra Holt Hightower",
            "Cecille Basilio", "Charles Izuakor", "Cherie Lebron", "Chevon Booker",
            "Chinedu Ezeh", "Christa Mcmullin", "Christina Clark", "Christina Silva",
            "Christina Sithole", "Christine Choi", "Christopher Linares", "Claire Daigle",
            "Claudia Franco", "Connie Gracia-Barraza", "Crystal Cohen", "Crystal Mendez",
            "Crystal Rivera", "Cynthia Barrilleaux", "Cynthia Bitterman", "Cynthia Timm",
            "D.M. Grant", "Dalese Hardin", "Dana Fikes", "Daniel Saldana",
            "Danielle O'Connor", "David Hadjichristodoulou", "Dawn Sebastian", "Dawnise Francisco",
            "Deanna Baldwin", "Debora Wechsler", "Deborah Francois", "Diana Olivas",
            "Dominique Harris", "Dora Marquez", "Douglas Klaif", "Douglas Reisgen",
            "Dulce Bacon", "Eberardo Rodriguez", "Edith Braswell-Grant", "Edith Janec",
            "Efren Rodriguez", "Eileen Alcorn", "Eimi Miller", "Elisabeth Mullins Medina",
            "Elizabeth Chavez", "Elizabeth Elizalde", "Elizabeth Romero", "Emilee Velazco Franco",
            "Emily Wassler", "Emir Gonzalez", "Enas Makar", "Eric Hopson",
            "Erica Pan", "Erica Sanchez", "Erika Paz", "Erin Mettlen",
            "Ester Yang", "Evelyn Mcfarlane", "Farhad Mahmud", "Frances Morales",
            "Freshta Sidiqi", "Gavriela Trujillo", "Gene Dean", "Genesis Aguirre",
            "Gina Go", "Gladys Barbosa", "Glenda Tamay", "Guillermo Diaz",
            "Gustavo Lopez", "Hamilton Gernon-Wyatt", "Hector Martinez", "Hina Ahmad",
            "Ida Quijada", "Iliana Quintero", "Indira Ortiz", "Irma Griffiths",
            "Irma Salas", "Irma Torres", "Isidro Castillo", "Ivy Grace Thorne",
            "Jacqueline Cruz", "Jacqueline Palacios", "Jakeisha Sanders", "Jamall Farr",
            "Janet Frnzyan", "Janet Ledesma", "Jasmin Segovia", "Javier Ponce Garcia",
            "Jeanine Flier", "Jeanne Garcia-Armstrong", "Jeen Yu", "Jehisol Urbina",
            "Jennifer Lopez", "Jennifer Washington", "Jenny Peterson", "Jereme Stark",
            "Jhun De Guzman", "Jiabei Li", "Jittima Bouillot", "John Kuykendall",
            "Jordan Baldry", "Jordan Gonzalez", "Jorge Torres", "Jose Alvarenga",
            "Jose Hernandez", "Jose Romero", "Joseph Thomas", "Joseph Zeccola",
            "Joshua Griffiths", "Joy Kasper", "Juan Catalan", "Juan Pina",
            "Julia Calamandrei", "Julian Mendez", "Julianne Fassett", "Julie Ann Resurreccion",
            "Julie Sornberger", "Karen Caruso", "Karen Siercke Noriega", "Karina Maravilla",
            "Karsina Gaither", "Kelsie Hogen", "Kelvin Means", "Kerry Shimizu",
            "Kevin Seegan", "Kimberly Rabas", "Kionna Hawkins", "Kristalyn Smith",
            "Kristine Adams", "Kristy Beaudry", "La Tresha Glasco", "Ladan Dejam",
            "Lailani Joy Gonzaga", "Lanette Black", "Laura Incelli", "Laveda Harris",
            "Lawrence Ramos", "Leslie Anderson", "Leslie Black", "Leslie Perez",
            "Leslie Zamora", "Leticia Gudino", "Leticia Martinez", "Liberty Amos",
            "Lila Rosas Madrigal", "Liliana Amezcua", "Liliana Jauregui-George", "Liliana Martinez",
            "Lilit Akilian", "Linda Hoang", "Linda Santana", "Linda Taylor",
            "Lisa Darbidian", "Lisa Harvey", "Lisa Marks", "Louise Cummings",
            "Luciano Latini", "Lucrecia Yescas Luna", "Ma Joanna Razon", "Ma Teresa Aki",
            "Maeli Montecinos", "Maikai Finnell", "Malika Ferrell", "Malina Rios",
            "Mandana Saidi", "Maria Aldave Cabrera", "Maria Hernandez", "Maria Pinto",
            "Maria Zamora", "Marianne Valencia", "Marie Bennett", "Marissa Gilmore",
            "Marites Felicilda", "Mark Todd", "Marla Pizzuto", "Marlene Yu",
            "Marta Martin", "Mary Jane Opoku", "Matthew Miller", "Mayra Alcantar",
            "Mayra Rodarte-Nava", "Melanie Ronning", "Melinda Duran", "Michael Juarez",
            "Michelle Lopez", "Miguel Agredano", "Miisha Davis", "Miriam Oguejiofor",
            "Nancy Madrid", "Naomi Kaidin", "Nayeli Meza Amaral", "Neta Markusfeld",
            "Nicole Douglass", "Nicoli Ueda", "Nora Watanabe", "Nune Mc Combs",
            "Oscar Montenegro", "Palma Scirone", "Paola Martinez", "Patricia Castillo",
            "Patricia Chavez", "Patrick Navas", "Paula Dominguez", "Paulette Duarte",
            "Paulette Shelley", "Pedro Aguilar", "Praveen Ray", "Ralph Bravo",
            "Rana Khan", "Raquel Huerta", "Rebeca Chaidez", "Rene Gaudet",
            "Rhory Rebellon", "Richard Lee", "Rick Swanson", "Robert Jones",
            "Robert Moose", "Robin Aaron", "Rodolfo Gutierrez", "Rosalina Pacheco",
            "Rosalyn Lee", "Rosanna Davisson", "Rosemarie Fagfoomsintu", "Ross Kramer",
            "Ruth Rendon", "Ryan Boyes", "Sabrina Sheikh", "Sabrina Sullivan",
            "Sallyann Tejeda", "Salvador Magana-Arriola", "Sandra Canela", "Sandra Hernandez",
            "Sandra Meredith", "Sandra Mijarez", "Sandra Valdivia", "Sandy Estrada",
            "Sandy Walker", "Sara Goico Alcantar", "Scott Cody", "Senisa Austin",
            "Shannon Moultrie", "Shannon Sayer", "Sharon Maculada", "Shawn Hall",
            "Sherita Rogers", "Sheveeta Jackson", "Silvia Ramos", "Silvia Sanchez",
            "Sofia Manzo-Reyes", "Sofia Vasserman", "Stacey Byham", "Stacey Williams",
            "Staci Holmes", "Stacy Orosco", "Stephanie Harlow", "Stephen Maccarone",
            "Steven Vitela", "Suhjung Ko", "Susan Deloach", "Susan Nolan",
            "Susana Mislang", "Susana Santa Cruz", "Susanna Garcia", "Tacy Schull",
            "Tamryn Wilkins", "Tanya Acosta", "Tarah Bagadiong-Trice", "Tatianika Montalbo",
            "Tiffanie Griffin", "Tiffany Vojkovich", "Toby Sperber", "Tonya Boyd",
            "Tonya Thompson", "Troy Poe", "Valerie De La Rosa", "Valerie Hoggard",
            "Vanessa Sandoval", "Veganush Frnzyan", "Veronica Arevalo", "Veronica Rodriguez Sifontes",
            "Veronica Viramontes", "Victor Castaneda", "Victoria Maldonado", "Wendy Jasso",
            "Wendy Marrero", "Wendy Mora", "Xiaowei Wei", "Yasmin Lilly",
            "Yesenia Duran", "Yesenia Enriquez", "Yolanda Hashimoto", "Young Choy",
            "Yuriko Jung", "Zarui Grigoryan", "Zina Dixon"
        ];
        
        // Context variables
        const urlParams_main = new URLSearchParams(window.location.search);
        const dateParam_main = urlParams_main.get('date');
        let baseDate_main = dateParam_main ? new Date(dateParam_main) : new Date();
        if (isNaN(baseDate_main.getTime())) baseDate_main = new Date();
        const startYear = baseDate_main.getMonth() < 6 ? baseDate_main.getFullYear() - 1 : baseDate_main.getFullYear();
        
        const PERSISTENCE_KEY = `icaap-tracking-data-${startYear}`;
        let saveTimeout;
        let allEmployees = [];

        async function init() {
            // Load all tracking data in parallel with fiscal year context
            const [hoursData, approvalData, paylogData] = await Promise.all([
                fetchHoursWorked(startYear),
                fetchApprovalDates(startYear),
                fetchPaylogSubmissions(startYear)
            ]);

            // Load custom/placeholder data
            const plannerData = await fetchPlannerData(PERSISTENCE_KEY, 1);
            
            // Extract all names from the fetched data
            const dbNames = new Set();
            hoursData.forEach(r => { if (r.name) dbNames.add(r.name); });
            approvalData.forEach(r => { if (r.Name) dbNames.add(r.Name); });
            paylogData.forEach(r => { if (r.name) dbNames.add(r.name); });

            // Merge hardcoded employees with any new names from DB
            const nameSet = new Set(employees.map(toTitleCase));
            dbNames.forEach(name => nameSet.add(toTitleCase(name)));
            allEmployees = [...nameSet].sort();

            // Re-render table rows if names changed or to ensure consistency
            renderTableRows();

            const hoursMap = {};
            hoursData.forEach(row => {
                if (row.name) hoursMap[row.name.toLowerCase()] = row;
            });

            const approvalMap = {};
            approvalData.forEach(row => {
                if (row.Name) approvalMap[row.Name.toLowerCase()] = row;
            });

            const paylogMap = {};
            paylogData.forEach(row => {
                if (row.name) paylogMap[row.name.toLowerCase()] = row;
            });

            // Populate custom data
            plannerData.forEach(item => {
                const el = document.querySelector(`[data-field="${item.field_id}"]`);
                if (el) el.innerText = item.content;
            });

            // Populate real data
            document.querySelectorAll('.editable-cell').forEach(cell => {
                const fieldId = cell.dataset.field;
                const parts = fieldId.split('-'); // icaap, mIdx/total, eIdx, type
                
                if (parts[1] === 'total') {
                    const eIdx = parseInt(parts[2]);
                    const empName = allEmployees[eIdx];
                    if (!empName) return;
                    const row = hoursMap[empName.toLowerCase()];
                    if (row && row.total !== undefined && row.total !== null) {
                        cell.innerText = row.total;
                    }
                } else if (parts.length === 4) {
                    const mIdx = parseInt(parts[1]);
                    const eIdx = parseInt(parts[2]);
                    const type = parts[3];
                    const empName = allEmployees[eIdx];
                    if (!empName) return;
                    const monthName = months[mIdx].split(' ')[0];
                    const lowerEmpName = empName.toLowerCase();

                    if (type === 'hours') {
                        const row = hoursMap[lowerEmpName];
                        if (row) {
                            const val = row[monthName.toLowerCase().substring(0, 3)];
                            if (val !== undefined && val !== null) cell.innerText = val;
                        }
                    } else if (type === 'approval') {
                        const row = approvalMap[lowerEmpName];
                        if (row) {
                            const val = row[monthName.substring(0, 3)];
                            if (val !== undefined && val !== null) cell.innerText = val;
                        }
                    } else if (type === 'paylog') {
                        const row = paylogMap[lowerEmpName];
                        if (row) {
                            const val = row[monthName.toLowerCase().substring(0, 3)];
                            if (val !== undefined && val !== null) cell.innerText = val;
                        }
                    }
                }

                cell.addEventListener('input', () => {
                    handleSave(cell);
                });
            });

            // Recalculate and display all totals in UI
            allEmployees.forEach((emp, eIdx) => {
                let total = 0;
                months.forEach((month, mIdx) => {
                    const hCell = document.querySelector(`[data-field="icaap-${mIdx}-${eIdx}-hours"]`);
                    if (hCell) total += parseFloat(hCell.innerText) || 0;
                });
                const tCell = document.querySelector(`[data-field="icaap-total-${eIdx}"]`);
                if (tCell) tCell.innerText = total || '';
            });
        }

        function renderTableRows() {
            const tbody = document.getElementById('tracking-body');
            tbody.innerHTML = '';
            allEmployees.forEach((emp, eIdx) => {
                const tr = document.createElement('tr');
                tr.innerHTML = `<td class="employee-col">${emp}</td>`;
                months.forEach((month, mIdx) => {
                    ['paylog', 'hours', 'approval'].forEach(type => {
                        const fieldId = `icaap-${mIdx}-${eIdx}-${type}`;
                        tr.innerHTML += `<td class="editable-cell" contenteditable="true" data-field="${fieldId}"></td>`;
                    });
                });
                // Add Total Hours cell
                const totalFieldId = `icaap-total-${eIdx}`;
                tr.innerHTML += `<td class="editable-cell" contenteditable="false" data-field="${totalFieldId}" style="font-weight: 600; background-color: #f1f8e9;"></td>`;
                tbody.appendChild(tr);
            });
        }

        async function updateTotalHours(eIdx) {
            const empName = allEmployees[eIdx];
            let total = 0;
            months.forEach((month, mIdx) => {
                const cell = document.querySelector(`[data-field="icaap-${mIdx}-${eIdx}-hours"]`);
                if (cell) {
                    const val = parseFloat(cell.innerText) || 0;
                    total += val;
                }
            });
            const totalCell = document.querySelector(`[data-field="icaap-total-${eIdx}"]`);
            if (totalCell) {
                totalCell.innerText = total || '';
                await saveTrackingData('hours_worked', empName, 'total', total.toString(), startYear);
            }
        }

        function handleSave(cell) {
            const fieldId = cell.dataset.field;
            const content = cell.innerText;
            const status = document.getElementById('save-status');
            status.innerText = 'Unsaved changes';
            clearTimeout(saveTimeout);
            saveTimeout = setTimeout(async () => {
                status.innerText = 'Saving...';
                
                const parts = fieldId.split('-');
                let success = false;
                
                if (parts[1] === 'total') {
                    const eIdx = parseInt(parts[2]);
                    const empName = allEmployees[eIdx];
                    success = await saveTrackingData('hours_worked', empName, 'total', content, startYear);
                } else {
                    const mIdx = parseInt(parts[1]);
                    const eIdx = parseInt(parts[2]);
                    const type = parts[3];
                    const empName = allEmployees[eIdx];
                    const monthName = months[mIdx].split(' ')[0];

                    if (type === 'hours') {
                        success = await saveTrackingData('hours_worked', empName, monthName, content, startYear);
                        updateTotalHours(eIdx);
                    } else if (type === 'approval') {
                        success = await saveTrackingData('approval_dates', empName, monthName, content, startYear);
                    } else if (type === 'paylog') {
                        success = await saveTrackingData('paylog_submission', empName, monthName, content, startYear);
                        if (!success) {
                            success = await savePlannerData(PERSISTENCE_KEY, fieldId, content);
                        }
                    }
                }
                
                status.innerText = success ? 'All changes saved' : 'Error saving';
            }, 1000);
        }
        document.addEventListener('DOMContentLoaded', init);
    </script>
</body>
</html>
