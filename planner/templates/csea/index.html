{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>CSEA Tracker - Opus One Planner</title>
  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  <link href="https://fonts.googleapis.com/css2?family=Cormorant+Garamond:wght@400;600;700&family=Source+Sans+3:wght@300;400;500;600;700&display=swap" rel="stylesheet" />
  <link rel="stylesheet" href="{% static 'css/core/opus-core.css' %}?v=20260108" />
  <link rel="stylesheet" href="{% static 'css/core/home.css' %}?v=20260108" />
  <link rel="stylesheet" href="{% static 'css/calendar/calendar.css' %}?v=20260108">
  <link rel="stylesheet" href="{% static 'css/csea/csea.css' %}?v=20260108" />
  <script src="https://cdn.tailwindcss.com"></script>
  <script>
    tailwind.config = {
      theme: {
        extend: {
          colors: {
            primary: '#00326b',
            primaryDark: '#002050',
            primaryLight: '#004a9c'
          }
        }
      }
    }
  </script>
  <style>
    .planner-header-right {
      display: flex;
      flex-wrap: wrap;
      gap: 8px;
      align-items: center;
    }
    
    .csea-tab-content.hidden {
      display: none;
    }

    /* Styles for Meeting Notes (from csea-meeting-notes.html) */
    .notes-layout {
      display: grid;
      gap: var(--opus-spacing-md);
    }
    .notes-form {
      display: grid;
      gap: var(--opus-spacing-md);
    }
    .notes-grid {
      display: grid;
      grid-template-columns: repeat(2, minmax(0, 1fr));
      gap: var(--opus-spacing-md);
    }
    .notes-grid .planner-form-group {
      margin: 0;
    }
    .notes-form textarea {
      min-height: 90px;
      resize: vertical;
    }
    .notes-actions {
      display: flex;
      justify-content: flex-end;
      gap: var(--opus-spacing-sm);
    }
    .notes-table-wrap {
      overflow-x: auto;
      border: 1px solid var(--opus-border);
      border-radius: var(--opus-border-radius);
      background: var(--opus-bg-white);
    }
    .notes-table {
      width: 100%;
      border-collapse: collapse;
      min-width: 980px;
    }
    .notes-table th, .notes-table td {
      border-bottom: 1px solid #e5e7eb;
      padding: 8px 10px;
      text-align: left;
      vertical-align: top;
      font-size: 8pt;
    }
    .notes-table th {
      background: #f1f5f9;
      text-transform: uppercase;
      letter-spacing: 0.08em;
      font-size: 0.75rem;
      color: #475569;
      font-weight: 700;
    }

    /* Styles for General Notes (from csea-notes.html) */
    .csea-notes-panel {
      background: #ffffff;
      border: 2px solid #7f9db3;
      border-radius: 12px;
      padding: 16px;
    }
    .csea-notes-panel h2 {
      margin: 0 0 8px;
      color: #0a2f5f;
      font-size: 1.2rem;
    }
    .csea-notes-panel textarea {
      width: 100%;
      min-height: 220px;
      border-radius: 10px;
      border: 1px solid #7f9db3;
      padding: 10px 12px;
      font-size: 1rem;
      color: #0a2f5f;
      background: #f8fafc;
      resize: vertical;
    }
    .csea-tags { margin-top: 10px; }
    .csea-tags-input { display: flex; gap: 8px; align-items: center; }
    .csea-tags-input input {
      flex: 1; border-radius: 8px; border: 1px solid #7f9db3; padding: 6px 10px;
      color: #0a2f5f; background: #ffffff;
    }
    .csea-tags-add {
      padding: 6px 10px; border-radius: 8px; border: 1px solid #7f9db3;
      background: #9ADBDE; color: #0a2f5f; font-weight: 700; cursor: pointer;
    }
    .csea-tags-list { list-style: none; margin: 8px 0 0; padding: 0; display: flex; flex-wrap: wrap; gap: 6px; }
    .csea-tag {
      display: inline-flex; align-items: center; gap: 6px; padding: 4px 8px;
      border-radius: 999px; background: #e6eef5; border: 1px solid #7f9db3;
      color: #0a2f5f; font-weight: 700; font-size: 0.85rem;
    }
    .csea-tag-delete { border: none; background: transparent; color: #0a2f5f; font-weight: 700; cursor: pointer; padding: 0; line-height: 1; }
    .csea-notes-actions { margin-top: 10px; display: flex; gap: 10px; align-items: center; }
    .csea-notes-save { padding: 6px 12px; border-radius: 8px; border: 1px solid #7f9db3; background: #99B3C5; color: #0a2f5f; font-weight: 700; cursor: pointer; }
    .csea-notes-clear { padding: 6px 12px; border-radius: 8px; border: 1px solid #d1d5db; background: #ffffff; color: #0a2f5f; font-weight: 700; cursor: pointer; }
    .csea-saved { margin-top: 12px; border-top: 1px solid #d5dbe5; padding-top: 10px; }
    .csea-saved h3 { margin: 0 0 8px; font-size: 0.95rem; color: #0a2f5f; }
    .csea-saved-list { list-style: none; margin: 0; padding: 0; display: flex; flex-direction: column; gap: 8px; }
    .csea-saved-item { border: 1px solid #7f9db3; border-radius: 10px; padding: 8px 10px; background: #ffffff; }
    .csea-saved-date { font-size: 0.8rem; color: #475569; margin-bottom: 4px; font-weight: 600; }
    .csea-saved-text { margin: 0; white-space: pre-wrap; color: #0a2f5f; }
    .csea-saved-row { display: flex; align-items: flex-start; justify-content: space-between; gap: 10px; }
    .csea-saved-delete { padding: 4px 10px; border-radius: 8px; border: 1px solid #d1d5db; background: #ffffff; color: #0a2f5f; font-weight: 700; cursor: pointer; white-space: nowrap; }
    .csea-saved-tags { display: flex; flex-wrap: wrap; gap: 6px; margin-top: 6px; }
    .csea-saved-clear { padding: 4px 10px; border-radius: 8px; border: 1px solid #d1d5db; background: #ffffff; color: #0a2f5f; font-weight: 700; cursor: pointer; }
  </style>
</head>
<body data-module="cseaPage">
  <div class="planner-container">
    {% include 'header_include.html' %}

    <div class="planner-content">
      <header class="planner-header">
        <div class="planner-header-left">
          <div>
            <h1>CSEA Tracker</h1>
            <p id="csea-subtitle">Stewarded member issues at a glance</p>
          </div>
          <div class="header-pills-container" style="display: flex; gap: 10px; margin-left: 20px;">
            <a href="/personal-planner/" class="planner-header-pill pill-personal">Personal Planner</a>
            <a href="/work-planner/" class="planner-header-pill pill-work">Work Planner</a>
            <button type="button" id="grievance-pill-btn" class="planner-header-pill pill-csea">Grievance Form</button>
          </div>
          <div class="header-pills-container sub-navigation" style="display: flex; gap: 10px; margin-left: 20px;">
            <button type="button" class="planner-subpage-pill csea-tab-btn active" data-tab="issues">Issue Log</button>
            <button type="button" class="planner-subpage-pill csea-tab-btn" data-tab="meetings">Meeting Notes</button>
            <button type="button" class="planner-subpage-pill csea-tab-btn" data-tab="notes">Notes</button>
          </div>
        </div>
        <div class="planner-header-right">
          <div class="planner-header-date" id="today-date"></div>
        </div>
      </header>

      <main class="planner-main">
        <!-- Issues Section -->
        <div id="issues-tab" class="csea-tab-content">
          <section class="planner-section csea-summary-section">
            <div class="planner-section-header">
              <span class="planner-section-icon">üîç</span>
              <h2 class="planner-section-title">Search Issues</h2>
            </div>
            <div class="planner-section-content">
              <div class="relative max-w-2xl">
                <input type="text" id="searchInput" placeholder="Search by CSEA Member, ID, description, or steward..." class="w-full px-4 py-1.5 pl-10 border border-gray-300 rounded-md focus:ring-2 focus:ring-primary focus:border-transparent outline-none">
                <i class="fa-solid fa-search absolute left-3 top-2.5 text-gray-400"></i>
              </div>
            </div>
          </section>

          <section class="planner-section csea-search-section">
            <div class="planner-section-header">
              <span class="planner-section-icon">üìä</span>
              <h2 class="planner-section-title">Issue Summary</h2>
            </div>
            <div class="grid grid-cols-4 gap-4 csea-stats-grid">
              <div class="bg-white rounded-lg shadow-md p-4 csea-stat-card border border-gray-100">
                <p class="text-gray-500 text-xs font-semibold uppercase tracking-wider">Total Issues</p>
                <p class="text-2xl font-bold text-primary mt-1" id="stat-total">0</p>
              </div>
              <div class="bg-white rounded-lg shadow-md p-4 csea-stat-card border border-gray-100">
                <p class="text-gray-500 text-xs font-semibold uppercase tracking-wider">Open</p>
                <p class="text-2xl font-bold text-blue-600 mt-1" id="stat-open">0</p>
              </div>
              <div class="bg-white rounded-lg shadow-md p-4 csea-stat-card border border-gray-100">
                <p class="text-gray-500 text-xs font-semibold uppercase tracking-wider">In Progress</p>
                <p class="text-2xl font-bold text-yellow-600 mt-1" id="stat-progress">0</p>
              </div>
              <div class="bg-white rounded-lg shadow-md p-4 csea-stat-card border border-gray-100">
                <p class="text-gray-500 text-xs font-semibold uppercase tracking-wider">Resolved</p>
                <p class="text-2xl font-bold text-green-600 mt-1" id="stat-resolved">0</p>
              </div>
            </div>
          </section>

          <section class="planner-section">
            <div class="planner-section-header">
              <span class="planner-section-icon">üìã</span>
              <h2 class="planner-section-title">Issue Log</h2>
            </div>
            <div class="overflow-x-auto">
              <table class="w-full csea-table">
                <thead class="bg-primary text-white">
                  <tr>
                    <th class="px-3 py-3 text-center text-sm font-semibold uppercase tracking-wider">Member ID</th>
                    <th class="px-3 py-3 text-center text-sm font-semibold uppercase tracking-wider">CSEA Member</th>
                    <th class="px-3 py-3 text-center text-sm font-semibold uppercase tracking-wider">Issue Type</th>
                    <th class="px-3 py-3 text-left text-sm font-semibold uppercase tracking-wider">Issue Description</th>
                    <th class="px-3 py-3 text-center text-sm font-semibold uppercase tracking-wider">Steward</th>
                    <th class="px-3 py-3 text-center text-sm font-semibold uppercase tracking-wider">Issue Priority</th>
                    <th class="px-3 py-3 text-center text-sm font-semibold uppercase tracking-wider">Issue Status</th>
                    <th class="px-3 py-3 text-center text-sm font-semibold uppercase tracking-wider">Issue Date</th>
                  </tr>
                </thead>
                <tbody id="issuesBody" class="divide-y divide-gray-200 text-center csea-table-body"></tbody>
              </table>
            </div>
          </section>
        </div>

        <!-- Meetings Section -->
        <div id="meetings-tab" class="csea-tab-content hidden">
          <section class="planner-section">
            <div class="planner-section-header">
              <span class="planner-section-icon">üìù</span>
              <h2 class="planner-section-title">Add Meeting Notes</h2>
            </div>
            <form id="meeting-notes-form" class="notes-form">
              <div class="notes-grid">
                <div class="planner-form-group">
                  <label class="planner-form-label" for="meeting-date">Date</label>
                  <input class="planner-form-input" type="date" id="meeting-date" required>
                </div>
                <div class="planner-form-group">
                  <label class="planner-form-label" for="member-name">Member Name</label>
                  <input class="planner-form-input" type="text" id="member-name" list="member-list" placeholder="Select or type a member" required>
                  <datalist id="member-list"></datalist>
                </div>
                <div class="planner-form-group">
                  <label class="planner-form-label" for="member-id">Member ID</label>
                  <input class="planner-form-input" type="text" id="member-id" placeholder="Member ID">
                </div>
                <div class="planner-form-group">
                  <label class="planner-form-label" for="steward-name">Steward</label>
                  <select class="planner-form-select" id="steward-name"></select>
                </div>
              </div>

              <div class="notes-grid">
                <div class="planner-form-group">
                  <label class="planner-form-label" for="meeting-summary">Summary</label>
                  <textarea class="planner-form-textarea" id="meeting-summary" required></textarea>
                </div>
                <div class="planner-form-group">
                  <label class="planner-form-label" for="meeting-outcome">Outcome</label>
                  <textarea class="planner-form-textarea" id="meeting-outcome"></textarea>
                </div>
                <div class="planner-form-group">
                  <label class="planner-form-label" for="meeting-next-steps">Next Steps</label>
                  <textarea class="planner-form-textarea" id="meeting-next-steps"></textarea>
                </div>
                <div class="planner-form-group">
                  <label class="planner-form-label" for="meeting-attachments">Attachments</label>
                  <input class="planner-form-input" type="file" id="meeting-attachments" multiple>
                </div>
              </div>

              <div class="notes-actions">
                <button type="reset" class="planner-button planner-button-secondary">Clear</button>
                <button type="submit" class="planner-button planner-button-primary">Save Notes</button>
              </div>
            </form>
          </section>

          <section class="planner-section">
            <div class="planner-section-header">
              <span class="planner-section-icon">üìã</span>
              <h2 class="planner-section-title">Saved Notes</h2>
            </div>
            <div class="notes-table-wrap">
              <table class="notes-table">
                <thead>
                  <tr>
                    <th>Date</th>
                    <th>Member</th>
                    <th>Member ID</th>
                    <th>Steward</th>
                    <th>Summary</th>
                    <th>Outcome</th>
                    <th>Next Steps</th>
                    <th>Attachments</th>
                    <th class="notes-actions-cell">Actions</th>
                  </tr>
                </thead>
                <tbody id="notes-body"></tbody>
              </table>
            </div>
          </section>
        </div>

        <!-- General Notes Section -->
        <div id="notes-tab" class="csea-tab-content hidden">
          <section class="planner-section" id="csea-notes-section">
            <div class="csea-notes-panel">
              <h2>General Notes</h2>
              <textarea id="csea-notes" placeholder="Add notes, follow-ups, or reminders here..."></textarea>
              <div class="csea-tags">
                <div class="csea-tags-input">
                  <input id="csea-tag-input" type="text" placeholder="Add a tag..." />
                  <button type="button" class="csea-tags-add" id="csea-tag-add">Add Tag</button>
                </div>
                <ul class="csea-tags-list" id="csea-tags-list"></ul>
              </div>
              <div class="csea-notes-actions">
                <button type="button" class="csea-notes-save" id="csea-notes-save">Save</button>
                <button type="button" class="csea-notes-clear" id="csea-notes-clear">Clear</button>
                <span class="csea-notes-status" id="csea-notes-status">Not saved</span>
              </div>
              <div class="csea-saved">
                <h3>Saved Items</h3>
                <div class="csea-saved-actions">
                  <input type="text" class="planner-form-input" id="csea-search" placeholder="Search notes or tags..." style="max-width: 240px;">
                  <button type="button" class="csea-saved-clear" id="csea-saved-clear">Clear Saved</button>
                </div>
                <ul class="csea-saved-list" id="csea-saved-list"></ul>
              </div>
            </div>
          </section>
        </div>
      </main>

      <footer class="planner-footer">
        &copy; 2025 Opus One Planner. All data is stored locally in your browser.
      </footer>
    </div>
  </div>

  <script src="{% static 'js/csea/csea.js' %}?v=20260108"></script>
  <script src="{% static 'js/csea/csea-ui.js' %}?v=20260108"></script>
  <script src="{% static 'js/csea/csea-meeting-notes.js' %}?v=20260108"></script>
  <script src="{% static 'js/csea/csea-notes-logic.js' %}?v=20260108"></script>
  <script src="{% static 'js/calendar/calendar-embed.js' %}?v=20260108"></script>
</body>
</html>
